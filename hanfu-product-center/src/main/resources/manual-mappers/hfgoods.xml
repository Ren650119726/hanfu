<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hanfu.product.center.manual.dao.ManualDaoImpl">

	<resultMap id="EntityHfGoodDispaly" type="com.hanfu.product.center.manual.model.HfGoodsDisplay">
    <result column="hf_name" jdbcType="VARCHAR" property="goodName" />
    <result column="goods_desc" jdbcType="VARCHAR" property="goodsDesc" />
    <result column="productCategoryName" jdbcType="VARCHAR" property="productCategoryName" />
    <result column="categoryId" jdbcType="INTEGER" property="categoryId" />
    <result column="quantity" jdbcType="INTEGER" property="quantity" />
    <result column="sell_price" jdbcType="INTEGER" property="sellPrice" />
    <result column="resp_id" jdbcType="INTEGER" property="respId" />
    <result column="price_id" jdbcType="INTEGER" property="priceId" />
    <result column="productId" jdbcType="INTEGER" property="productId" />
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="modify_time" jdbcType="TIMESTAMP" property="modifyTime" />
    <result column="is_deleted" jdbcType="SMALLINT" property="isDeleted" />
    <result column="cancel_id" jdbcType="INTEGER" property="cancelId" />
    <result column="claim" jdbcType="INTEGER" property="claim" />
    <result column="frames" jdbcType="INTEGER" property="frames" />
   </resultMap>
   
	<resultMap id="EntityHfGoodDispaly1" type="com.hanfu.inner.model.product.center.HfGoodsDisplay">
    <result column="hf_name" jdbcType="VARCHAR" property="goodName" />
    <result column="goods_desc" jdbcType="VARCHAR" property="goodsDesc" />
    <result column="productCategoryName" jdbcType="VARCHAR" property="productCategoryName" />
    <result column="categoryId" jdbcType="INTEGER" property="categoryId" />
    <result column="quantity" jdbcType="INTEGER" property="quantity" />
    <result column="sell_price" jdbcType="INTEGER" property="sellPrice" />
    <result column="resp_id" jdbcType="INTEGER" property="respId" />
    <result column="price_id" jdbcType="INTEGER" property="priceId" />
    <result column="productId" jdbcType="INTEGER" property="productId" />
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="modify_time" jdbcType="TIMESTAMP" property="modifyTime" />
    <result column="is_deleted" jdbcType="SMALLINT" property="isDeleted" />
   </resultMap>
   
   <resultMap id="BaseResultMap" type="com.hanfu.product.center.model.HfGoods">
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="hf_name" jdbcType="INTEGER" property="goodName" />
    <result column="instance_id" jdbcType="INTEGER" property="instanceId" />
    <result column="product_id" jdbcType="INTEGER" property="productId" />
    <result column="category_id" jdbcType="INTEGER" property="categoryId" />
    <result column="stone_id" jdbcType="INTEGER" property="stoneId" />
    <result column="boss_id" jdbcType="INTEGER" property="bossId" />
    <result column="brand_id" jdbcType="INTEGER" property="brandId" />
    <result column="resp_id" jdbcType="INTEGER" property="respId" />
    <result column="price_id" jdbcType="INTEGER" property="priceId" />
    <result column="goods_desc" jdbcType="VARCHAR" property="goodsDesc" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="modify_time" jdbcType="TIMESTAMP" property="modifyTime" />
    <result column="is_deleted" jdbcType="SMALLINT" property="isDeleted" />
  </resultMap>
  
<!--   <resultMap id="AwardInfoEntityMap" 
		type="cn.tedu.store.entity.AwardInfo">
		<id column="id" property="id"/>
		<result column="award_name" property="awardName"/>
		<result column="emp_num" property="empNum"/>
	</resultMap> -->
  
  	<select id="selectAllGoodsInfo" resultMap="EntityHfGoodDispaly1">
			SELECT
				h.goods_desc,h.id,
				h.hf_name,h.resp_id,
				h.price_id,h1.hf_name productCategoryName,
				h1.id categoryId,p.id productId,
				h.create_time,h.modify_time,
				h.is_deleted
			FROM 
				hf_goods h 
			JOIN 
				product p 
			ON
		    	h.product_id = p.id 
		    JOIN 
		    	hf_category h1 
		    ON 
		    	h.category_id = h1.id
		    <if test="stoneId != null and stoneId != ''">
    	    WHERE
		        h.stone_id=#{stoneId}
    	    </if>
		    
	</select>
   
	<select id="selectAllGoods" resultMap="EntityHfGoodDispaly">
			SELECT
				h.goods_desc,h.id,
				h.hf_name,h.resp_id,
				h.price_id,h1.hf_name productCategoryName,
				h1.id categoryId,p.id productId,
				h3.sell_price,h.create_time,
				h.modify_time,h.is_deleted
			FROM 
				hf_goods h 
			JOIN 
				product p 
			ON
		    	h.product_id = p.id 
		    JOIN 
		    	hf_category h1 
		    ON 
		    	h.category_id = h1.id
		    JOIN
		    	hf_price h3
		    ON
		    	h.price_id = h3.id
		    WHERE
		        h.stone_id=#{stoneId}
	</select>
	
	<select id="selectAllGoodsPartInfo" resultMap="EntityHfGoodDispaly">
			SELECT
				h.goods_desc,h.id,
				h.hf_name,h.resp_id,
				h.price_id,h1.hf_name productCategoryName,
				h1.id categoryId,p.id productId,
				h.create_time,h.modify_time,
				h.is_deleted
			FROM 
				hf_goods h 
			JOIN 
				product p 
			ON
		    	h.product_id = p.id 
		    JOIN 
		    	hf_category h1 
		    ON 
		    	h.category_id = h1.id
		    WHERE
		        h.stone_id=#{stoneId}
	</select>
	
	<select id="selectByStoneId" resultMap="BaseResultMap">
			SELECT 
				distinct id, instance_id,
			    product_id, category_id,
			    stone_id, boss_id,
			    brand_id, resp_id,
			    price_id, goods_desc,
			    create_time,modify_time,
			    is_deleted
			FROM
				hf_goods
			WHERE
				stone_id = #{stoneId}
	</select>
	
	<select id="selectGoodsInfo" resultMap="EntityHfGoodDispaly">
		SELECT
				h.goods_desc,h.id,
				h.hf_name,h.resp_id,
				h.price_id,h1.hf_name productCategoryName,
				h1.id categoryId,p.id productId,
				h3.sell_price,h.create_time,
				h.modify_time,h.is_deleted,h.cancel_id,h.claim,h.frames
			FROM 
				hf_goods h 
			JOIN 
				product p 
			ON
		    	h.product_id = p.id 
		    JOIN 
		    	hf_category h1 
		    ON 
		    	h.category_id = h1.id
		    JOIN
		    	hf_price h3
		    ON
		    	h.price_id = h3.id
		    JOIN
		        cancel h4
		    ON 
		        h.cancel_id = h4.id	
		    WHERE
		        h.id=#{goodsId}
	</select>
	
	<select id="selectGoodsPartInfo" resultMap="EntityHfGoodDispaly">
		SELECT
				h.goods_desc,h.id,
				h.hf_name,h.resp_id,
				h.price_id,h1.hf_name productCategoryName,
				h1.id categoryId,p.id productId,
				h.create_time,h.modify_time,h.cancel_id,h.claim,h.frames,
				h.is_deleted
			FROM 
				hf_goods h 
			JOIN 
				product p 
			ON
		    	h.product_id = p.id 
		    JOIN 
		    	hf_category h1 
		    ON 
		    	h.category_id = h1.id
		    JOIN
		        cancel h4
		    ON 
		        h.cancel_id = h4.id	
		    WHERE
		        h.id=#{goodsId}
	</select>
	
	<select id="selectProductBycategoryIdOrProductName" resultMap="EntityHfGoodDispaly">
  		SELECT
				h.goods_desc,h.id,
				h.hf_name,h.resp_id,
				h.price_id,h1.hf_name productCategoryName,
				h1.id categoryId,p.id productId,
				h.create_time,h.modify_time,
				h.is_deleted
			FROM 
				hf_goods h 
			JOIN 
				product p 
			ON
		    	h.product_id = p.id 
		    JOIN 
		    	hf_category h1 
		    ON 
		    	h.category_id = h1.id
    	    <if test="goodName != null and goodName != ''">
    	    	WHERE h.hf_name like '%${goodName}%'
    	    </if>
    	    <if test="categoryId != null and categoryId != ''">
    	    	AND h1.id = #{categoryId} 
    	    </if>
  </select>
	
	<update id="updateGoods">
			UPDATE 
				hf_goods
			SET 
				good_name = #{goodName},price_id = #{priceId},
				resp_id = #{respId},goods_desc = #{goodsDesc}
			WHERE
				id = #{id}
	</update>
	
	<insert id="insertAwardInfo" useGeneratedKeys="true"
		keyProperty="id">
		INSERT INTO 
				award(award_name,emp_num) 
		values(#{awardName},#{empNum})
	</insert>
	
</mapper>